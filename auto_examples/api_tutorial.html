<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Docutils 0.19: https://docutils.sourceforge.io/" name="generator"/>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <meta content="ie=edge" http-equiv="x-ua-compatible"/>
  <meta content="Copy to clipboard" name="lang:clipboard.copy"/>
  <meta content="Copied to clipboard" name="lang:clipboard.copied"/>
  <meta content="en" name="lang:search.language"/>
  <meta content="True" name="lang:search.pipeline.stopwords"/>
  <meta content="True" name="lang:search.pipeline.trimmer"/>
  <meta content="No matching documents" name="lang:search.result.none"/>
  <meta content="1 matching document" name="lang:search.result.one"/>
  <meta content="# matching documents" name="lang:search.result.other"/>
  <meta content="[\s\-]+" name="lang:search.tokenizer"/>
  <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&amp;display=fallback" rel="stylesheet"/>
  <style>
   body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
  </style>
  <link href="../_static/stylesheets/application.css" rel="stylesheet"/>
  <link href="../_static/stylesheets/application-palette.css" rel="stylesheet"/>
  <link href="../_static/stylesheets/application-fixes.css" rel="stylesheet"/>
  <link href="../_static/fonts/material-icons.css" rel="stylesheet"/>
  <meta content="#036291" name="theme-color"/>
  <script src="../_static/javascripts/modernizr.js">
  </script>
  <link href="../_static/images/logo.png" rel="apple-touch-icon"/>
  <title>
   Introductory example - using the API — Flux RESTful API
  </title>
  <link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/material.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/sg_gallery.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/sg_gallery-binder.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/sg_gallery-dataframe.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/sg_gallery-rendered-html.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/css/rtd_sphinx_search.min.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/custom.css" rel="stylesheet" type="text/css"/>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js">
  </script>
  <script src="../_static/jquery.js">
  </script>
  <script src="../_static/underscore.js">
  </script>
  <script src="../_static/_sphinx_javascript_frameworks_compat.js">
  </script>
  <script src="../_static/doctools.js">
  </script>
  <script src="../_static/sphinx_highlight.js">
  </script>
  <script src="../_static/clipboard.min.js">
  </script>
  <script src="../_static/copybutton.js">
  </script>
  <script src="../_static/js/rtd_sphinx_search.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js">
  </script>
  <link href="../_static/favicon.ico" rel="shortcut icon"/>
  <link href="../genindex.html" rel="index" title="Index"/>
  <link href="../search.html" rel="search" title="Search"/>
  <link href="../contributing.html" rel="next" title="Contributing"/>
  <link href="index.html" rel="prev" title="Tutorials"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
  <!-- Social: Facebook / Open Graph -->
  <title>
   Flux RESTful API in Python
  </title>
  <link href="https://flux-framework.github.io/flux-restful-api/" rel="canonical"/>
  <meta content="website" property="og:type"/>
  <meta content="https://flux-framework.github.io/flux-restful-api/" property="og:url"/>
  <meta content="Flux RESTful API" property="og:title"/>
  <meta content="https://raw.githubusercontent.com/flux-framework/flux-restful-api/main/docs/images/logo.png" property="og:image"/>
  <meta content="Flux RESTful API in Python" property="og:description"/>
  <meta content="Flux RESTful API" property="og:site_name"/>
  <meta content="en_US" property="og:locale"/>
  <!-- Social: Twitter -->
  <meta content="summary" name="twitter:card"/>
  <meta content="@FluxFramework" name="twitter:site"/>
  <meta content="Flux Framework" name="twitter:title"/>
  <meta content="Flux RESTFul API in Python" name="twitter:description"/>
  <meta content="https://raw.githubusercontent.com/flux-framework/flux-restful-api/main/docs/images/logo.png" name="twitter:image"/>
  <!-- Social: Google+ / Schema.org  -->
  <meta content="Flux RESTful API" itemprop="name"/>
  <meta content="Flux RESTFul API in Python" itemprop="description"/>
  <meta content="https://raw.githubusercontent.com/flux-framework/flux-restful-api/main/docs/images/logo.png" itemprop="image"/>
  <script type="application/ld+json">
   {"@type":"WebSite","headline":"Flux RESTful API","url":"https://flux-framework.github.io/flux-restful-api","description":"Flux RESTful API in Python","name":"Flux RESTful API","@context":"https://schema.org"}
  </script>
  <style>
   .material-symbols-outlined {
  font-variation-settings:
  'FILL' 0,
  'wght' 400,
  'GRAD' 0,
  'opsz' 48
}
.sphx-glr-script-out .highlight pre {
  background-color: #def0ff !important;
}
  </style>
  <link href="../_static/images/logo.png" rel="apple-touch-icon"/>
 </head>
 <body data-md-color-accent="blue" data-md-color-primary="blue" dir="ltr">
  <svg class="md-svg">
   <defs data-children-count="0">
    <svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg">
     <path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor">
     </path>
    </svg>
   </defs>
  </svg>
  <input class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
  <input class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
  <label class="md-overlay" data-md-component="overlay" for="__drawer">
  </label>
  <a class="md-skip" href="#auto_examples/api_tutorial" tabindex="1">
   Skip to content
  </a>
  <header class="md-header" data-md-component="header">
   <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
     <div class="md-flex__cell md-flex__cell--shrink">
      <a class="md-header-nav__button md-logo" href="../index.html" title="Flux RESTful API">
       <span class="material-symbols-outlined">
        cycle
       </span>
      </a>
     </div>
     <div class="md-flex__cell md-flex__cell--shrink">
      <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer">
      </label>
     </div>
     <div class="md-flex__cell md-flex__cell--stretch">
      <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
       <span class="md-header-nav__topic" style="width: 1046px;margin-left: -20px;">
        Flux RESTful API
       </span>
       <span class="md-header-nav__topic">
        Introductory example - using the API
       </span>
      </div>
     </div>
     <div class="md-flex__cell md-flex__cell--shrink">
      <label class="md-icon md-icon--search md-header-nav__button" for="__search">
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
       <label class="md-search__overlay" for="__search">
       </label>
       <div class="md-search__inner" role="search">
        <form action="../search.html" class="md-search__form" method="get" name="search">
         <input autocapitalize="off" autocomplete="off" class="md-search__input" data-md-component="query" data-md-state="active" name="q" placeholder="Search" spellcheck="false" type="text"/>
         <label class="md-icon md-search__icon" for="__search">
         </label>
         <button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
          
         </button>
        </form>
        <div class="md-search__output">
         <div class="md-search__scrollwrap" data-md-scrollfix="">
          <div class="md-search-result" data-md-component="result">
           <div class="md-search-result__meta">
            Type to start searching
           </div>
           <ol class="md-search-result__list">
           </ol>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="md-flex__cell md-flex__cell--shrink">
      <div class="md-header-nav__source">
       <a class="md-source" data-md-source="github" href="https://github.com/flux-framework/flux-restful-api/" title="Go to repository">
        <div class="md-source__icon">
         <!--<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>-->
         <!-- updated to match riverml.xml site-->
         <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
          <path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z" fill="#ffffff">
          </path>
         </svg>
        </div>
        <div class="md-source__repository">
         Flux RESTful API
        </div>
       </a>
      </div>
     </div>
    </div>
   </nav>
  </header>
  <div class="md-container">
   <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
     <ul class="md-tabs__list">
      <li class="md-tabs__item">
       <a class="md-tabs__link" href="https://flux-framework.org/">
        Flux Framework
       </a>
      </li>
      <li class="md-tabs__item">
       <a class="md-tabs__link" href="https://github.com/flux-framework">
        Flux Framework on GitHub
       </a>
      </li>
      <li class="md-tabs__item">
       <a class="md-tabs__link" href="https://github.com/flux-framework/flux-restful-api">
        Flux RESTful API on GitHub
       </a>
      </li>
      <li class="md-tabs__item">
       <a class="md-tabs__link" href="index.html">
        Tutorials
       </a>
      </li>
     </ul>
    </div>
   </nav>
   <main class="md-main">
    <div class="md-main__inner md-grid" data-md-component="container">
     <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
      <div class="md-sidebar__scrollwrap">
       <div class="md-sidebar__inner">
        <nav class="md-nav md-nav--primary" data-md-level="0">
         <label class="md-nav__title md-nav__title--site" for="__drawer">
          <a class="md-nav__button md-logo" href="../index.html" title="Flux RESTful API">
           <i class="md-icon">
            cycle
           </i>
          </a>
          <a href="../index.html" title="Flux RESTful API">
           Flux RESTful API
          </a>
         </label>
         <div class="md-nav__source">
          <a class="md-source" data-md-source="github" href="https://github.com/flux-framework/flux-restful-api/" title="Go to repository">
           <div class="md-source__icon">
            <!--<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>-->
            <!-- updated to match riverml.xml site-->
            <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
             <path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z" fill="#ffffff">
             </path>
            </svg>
           </div>
           <div class="md-source__repository">
            Flux RESTful API
           </div>
          </a>
         </div>
         <ul class="md-nav__list">
          <li class="md-nav__item">
           <a class="md-nav__link" href="../getting_started/index.html">
            Documentation
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="index.html">
            Tutorials
           </a>
           <ul class="md-nav__list">
            <li class="md-nav__item">
             <a class="md-nav__link" href="index.html#api-examples">
              API Examples
             </a>
            </li>
           </ul>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="../contributing.html">
            Contributing
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="../about/license.html">
            License
           </a>
          </li>
          <li class="md-nav__item">
           <span class="md-nav__link caption">
            <span class="caption-text">
             API
            </span>
           </span>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="../source/modules.html">
            app
           </a>
          </li>
         </ul>
        </nav>
       </div>
      </div>
     </div>
     <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
      <div class="md-sidebar__scrollwrap">
       <div class="md-sidebar__inner">
        <nav class="md-nav md-nav--secondary">
         <ul class="md-nav__list" data-md-scrollfix="">
          <li class="md-nav__item">
           <a class="md-nav__extra_link" href="../_sources/auto_examples/api_tutorial.rst.txt">
            Show Source
           </a>
          </li>
          <li class="md-nav__item" id="searchbox">
          </li>
         </ul>
        </nav>
       </div>
      </div>
     </div>
     <div class="md-content">
      <article class="md-content__inner md-typeset" role="main">
       <div class="sphx-glr-download-link-note admonition note">
        <p class="admonition-title">
         Note
        </p>
        <p>
         Click
         <a class="reference internal" href="#sphx-glr-download-auto-examples-api-tutorial-py">
          <span class="std std-ref">
           here
          </span>
         </a>
         to download the full example code
        </p>
       </div>
       <section class="sphx-glr-example-title" id="introductory-example-using-the-api">
        <span id="sphx-glr-auto-examples-api-tutorial-py">
        </span>
        <h1 id="auto-examples-api-tutorial--page-root">
         Introductory example - using the API
         <a class="headerlink" href="#auto-examples-api-tutorial--page-root" title="Permalink to this heading">
          ¶
         </a>
        </h1>
        <p>
         This small tutorial walks through the basics of using an API.
The most basic thing to do is submit a job to the API,
list, get statuses, cancel. We can use our example client for this.
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">flux_restful_client.main</span> <span class="kn">import</span> <span class="n">get_client</span>

<span class="c1"># This is expected to be rendered from docs root</span>
<span class="n">here</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>

<span class="c1"># This is here for the nice thumbnail :)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">,</span> <span class="s2">"logo.png"</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"off"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
         </div>
        </div>
        <img alt="api tutorial" class="sphx-glr-single-img" src="../_images/sphx_glr_api_tutorial_001.png" srcset="../_images/sphx_glr_api_tutorial_001.png"/>
        <p>
         Here we instantiate a client. If you need authentication, this can optionally take
a user and token, or also derive from the FLUX_USER and FLUX_TOKEN in the
environment.
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="n">cli</span> <span class="o">=</span> <span class="n">get_client</span><span class="p">()</span>
</pre>
         </div>
        </div>
        <p>
         Let’s list the nodes in our cluster!
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Listing nodes"</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">list_nodes</span><span class="p">()</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>Listing nodes
{
    "nodes": [
        "68d005228015"
    ]
}
</pre>
         </div>
        </div>
        <p>
         Now let’s submit a job to Flux.
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"😴 Submitting job sleep 60"</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">"sleep"</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>

<span class="c1"># This is an indication something went wrong - detail has an error.</span>
<span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="s2">"detail"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">"detail"</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>😴 Submitting job sleep 60
{'command': 'sleep 60'}
</pre>
         </div>
        </div>
        <p>
         To require auth, the server should be startup with these variables
in the environment (and the first two found by the client here)
variables exported:
FLUX_USER=fluxuser
FLUX_TOKEN=12345
FLUX_REQUIRE_AUTH=true
        </p>
        <p>
         And finally, let’s get job info.
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"🍓 Getting job info..."</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">jobs</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">"id"</span><span class="p">])</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>🍓 Getting job info...
{
    "id": 731352399872,
    "userid": 0,
    "urgency": 16,
    "priority": 16,
    "t_submit": 1674331610.0085645,
    "t_depend": 1674331610.020076,
    "state": "SCHED",
    "name": "sleep",
    "ntasks": 1,
    "ncores": 1,
    "duration": 0.0,
    "nnodes": "",
    "result": "",
    "returncode": "",
    "runtime": 0.0,
    "waitstatus": "",
    "nodelist": "",
    "exception": {
        "occurred": "",
        "severity": "",
        "type": "",
        "note": ""
    }
}
</pre>
         </div>
        </div>
        <p>
         And job logs
This will be added to the client
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"😴 Submitting job to echo pancakes 🥞🥞🥞"</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">"echo pancakes are really just morning cakes."</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">"id"</span><span class="p">])</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>😴 Submitting job to echo pancakes 🥞🥞🥞
{'command': 'echo pancakes are really just morning cakes.'}
{
    "Output": [
        "pancakes are really just morning cakes.\n"
    ]
}
</pre>
         </div>
        </div>
        <p>
         Now let’s submit three jobs in unison so we can list them back!
Submit the job to flux
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Submitting 3 jobs to sleep!"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">seconds</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]:</span>
    <span class="n">cli</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">"sleep"</span><span class="p">,</span> <span class="n">seconds</span><span class="p">])</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">jobs</span><span class="p">()</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>Submitting 3 jobs to sleep!
{'command': 'sleep 10'}
{'command': 'sleep 20'}
{'command': 'sleep 30'}
{
    "jobs": [
        {
            "id": 819483115520,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331615.2620142,
            "t_depend": 1674331615.273345,
            "state": 8,
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0
        },
        {
            "id": 819986432000,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331615.291258,
            "t_depend": 1674331615.3026,
            "state": 8,
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0
        },
        {
            "id": 818979799040,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331615.231217,
            "t_depend": 1674331615.2426803,
            "t_run": 1674331615.256992,
            "state": 16,
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0,
            "nnodes": 1,
            "ranks": "0",
            "nodelist": "68d005228015",
            "expiration": 4827931615.0
        },
        {
            "id": 731352399872,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331610.0085645,
            "t_depend": 1674331610.020076,
            "t_run": 1674331610.0350156,
            "state": 16,
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0,
            "nnodes": 1,
            "ranks": "0",
            "nodelist": "68d005228015",
            "expiration": 4827931610.0
        },
        {
            "id": 731956379648,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331610.0448632,
            "t_depend": 1674331610.0565822,
            "t_run": 1674331610.0713265,
            "t_cleanup": 1674331610.0932524,
            "t_inactive": 1674331610.0953186,
            "state": 64,
            "name": "echo",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0,
            "nnodes": 1,
            "ranks": "0",
            "nodelist": "68d005228015",
            "success": true,
            "exception_occurred": false,
            "result": 1,
            "expiration": 4827931610.0,
            "waitstatus": 0
        }
    ]
}
</pre>
         </div>
        </div>
        <p>
         And this is how to search (with a start, length, or query)
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"🌓 Querying jobs!"</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">"sleep"</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>🌓 Querying jobs!
{
    "data": [
        {
            "id": 819986432000,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331615.291258,
            "t_depend": 1674331615.3026,
            "state": "SCHED",
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0,
            "nnodes": "",
            "result": "",
            "returncode": "",
            "runtime": 0.0,
            "waitstatus": "",
            "nodelist": "",
            "exception": {
                "occurred": "",
                "severity": "",
                "type": "",
                "note": ""
            }
        },
        {
            "id": 818979799040,
            "userid": 0,
            "urgency": 16,
            "priority": 16,
            "t_submit": 1674331615.231217,
            "t_depend": 1674331615.2426803,
            "t_run": 1674331615.256992,
            "state": "RUN",
            "name": "sleep",
            "ntasks": 1,
            "ncores": 1,
            "duration": 0.0,
            "nnodes": 1,
            "ranks": "0",
            "nodelist": "68d005228015",
            "expiration": 4827931615.0,
            "result": "",
            "returncode": "",
            "runtime": 0.07028341293334961,
            "waitstatus": "",
            "exception": {
                "occurred": "",
                "severity": "",
                "type": "",
                "note": ""
            }
        }
    ],
    "draw": 1,
    "recordsTotal": 5,
    "recordsFiltered": 2
}
</pre>
         </div>
        </div>
        <p>
         Finally, let’s submit and cancel a job
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Submitting job sleep 60 intending to cancel.."</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">"sleep"</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="k">if</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Requesting job cancel.."</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">"id"</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>Submitting job sleep 60 intending to cancel..
{'command': 'sleep 60'}
{
    "Message": "Job submit.",
    "id": 820724629504
}
Requesting job cancel..
{
    "Message": "Job is requested to cancel."
}
</pre>
         </div>
        </div>
        <p>
         And this would be how you stop your cluster service
        </p>
        <div class="highlight-default notranslate">
         <div class="highlight">
          <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Stopping the service..."</span><span class="p">)</span>
<span class="c1"># res = cli.stop_service()</span>
</pre>
         </div>
        </div>
        <div class="sphx-glr-script-out highlight-none notranslate">
         <div class="highlight">
          <pre><span></span>Stopping the service...
</pre>
         </div>
        </div>
        <p class="sphx-glr-timing">
         <strong>
          Total running time of the script:
         </strong>
         ( 0 minutes  5.601 seconds)
        </p>
        <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-api-tutorial-py">
         <div class="sphx-glr-download sphx-glr-download-python docutils container">
          <p>
           <a class="reference download internal" download="" href="../_downloads/6e9bc02a92b40b47044c2fd1606a9cb6/api_tutorial.py">
            <code class="xref download docutils literal notranslate">
             <span class="pre">
              Download
             </span>
             <span class="pre">
              Python
             </span>
             <span class="pre">
              source
             </span>
             <span class="pre">
              code:
             </span>
             <span class="pre">
              api_tutorial.py
             </span>
            </code>
           </a>
          </p>
         </div>
         <div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
          <p>
           <a class="reference download internal" download="" href="../_downloads/e4ffdec77681510495352ac10bb10123/api_tutorial.ipynb">
            <code class="xref download docutils literal notranslate">
             <span class="pre">
              Download
             </span>
             <span class="pre">
              Jupyter
             </span>
             <span class="pre">
              notebook:
             </span>
             <span class="pre">
              api_tutorial.ipynb
             </span>
            </code>
           </a>
          </p>
         </div>
        </div>
        <p class="sphx-glr-signature">
         <a class="reference external" href="https://sphinx-gallery.github.io">
          Gallery generated by Sphinx-Gallery
         </a>
        </p>
       </section>
      </article>
     </div>
    </div>
   </main>
  </div>
  <footer class="md-footer">
   <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
     <a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="index.html" rel="prev" title="Tutorials">
      <div class="md-flex__cell md-flex__cell--shrink">
       <i class="md-icon md-icon--arrow-back md-footer-nav__button">
       </i>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
       <span class="md-flex__ellipsis">
        <span class="md-footer-nav__direction">
         Previous
        </span>
        Tutorials
       </span>
      </div>
     </a>
     <a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../contributing.html" rel="next" title="Contributing">
      <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
       <span class="md-flex__ellipsis">
        <span class="md-footer-nav__direction">
         Next
        </span>
        Contributing
       </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
       <i class="md-icon md-icon--arrow-forward md-footer-nav__button">
       </i>
      </div>
     </a>
    </nav>
   </div>
   <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
     <div class="md-footer-copyright">
      <div class="md-footer-copyright__highlight">
       © Copyright 2022, Flux RESTful API Developers.
      </div>
      Last updated on
              Jan 21, 2023.
      <br/>
      Created using
      <a href="http://www.sphinx-doc.org/">
       Sphinx
      </a>
      5.3.0.
             and
      <a href="https://github.com/bashtage/sphinx-material/">
       Material for
              Sphinx
      </a>
     </div>
    </div>
   </div>
  </footer>
  <script src="../_static/javascripts/application.js">
  </script>
  <script>
   app.initialize({version: "1.0.4", url: {base: ".."}})
  </script>
 </body>
</html>